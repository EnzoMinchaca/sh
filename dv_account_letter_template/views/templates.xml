<?xml version='1.0' encoding='utf-8'?>
<odoo>
  <template id="report_letter_template">
    <t t-call="web.html_container">
      <meta charset="UTF-8"/>
      <t t-foreach="[1, 2]" t-as="index">
        <div class="page" t-attf-style="margin-top: #{'100px' if index == 2 else '0px'};">
          <t t-foreach="docs" t-as="o">
            <div class="container">
              <!-- Tabla de encabezado-->
              <table class="table-borderless" style="width: 100%;">
                <tr>
                  <!-- Logo: 2 columnas x 4 filas -->
                  <td colspan="2" rowspan="4" style="vertical-align: top;">
                      <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)" style="max-height: 80px;" alt="Logo"/>
                  </td>
                  <!-- Street: 4 columnas x 1 fila -->
                  <td colspan="4" style="padding-bottom: 0px;">
                      <span t-out="o.company_id.street">Street</span> -
                      <span t-out="o.company_id.partner_id.l10n_pe_district.name">Distrit</span> - 
                      <span t-out="o.company_id.city">City</span> - 
                      <span t-out="o.company_id.state_id.name">State</span>
                  </td>
                </tr>
                <tr>
                  <!-- Teléfonos: 3 columnas x 1 fila -->
                  <td colspan="3" style="padding-bottom: 0px;">
                      Telf.: <span t-out="o.company_id.phone">Phone</span>&#160;
                      Cel.: <span t-out="o.company_id.mobile">Mobile</span>
                  </td>
                  <td colspan="1" style="padding-bottom: 0px;">
                  </td>
                </tr>
                <tr>
                  <!-- Website: 2 columnas x 1 fila -->
                  <td colspan="2" style="font-weight: bold; padding-bottom: 0px;">
                      <span t-out="o.company_id.website">Website</span>
                  </td>
                  <td colspan="2" style="padding-bottom: 0px;">
                  </td>
                </tr>
                <tr>
                  <!-- Email: 2 columnas x 2 filas -->
                  <td colspan="3" style="vertical-align: top; padding-bottom: 0px;">
                      <span t-out="o.company_id.email">Email</span>
                  </td>
                  <!-- RUC: 2 columnas x 1 fila -->
                  <td colspan="1" style="vertical-align: top; font-size: 150%; padding-bottom: 0px;">
                      RUC N° <span t-out="o.company_id.vat">VAT</span>
                  </td>
                </tr>
              </table>
            </div>
            <div class="page">
              <!-- Tabla de giro -->
              <table class="rounded-corners">
                <thead>
                  <tr>
                    <td style="border-right: 1px solid black;">NUMERO</td>
                    <td style="border-right: 1px solid black;">REF. DEL GIRADOR</td>
                    <td style="border-right: 1px solid black;">FECHA DE GIRO</td>
                    <td style="border-right: 1px solid black;">LUGAR DE GIRO</td>
                    <td style="border-right: 1px solid black;">FECHA DE VENCIMIENTO</td>
                    <td>MONEDA E IMPORTE</td>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td rowspan="2" style="border-right: 1px solid black; border-top: 1px solid black;">
                      <span t-out="o.name">NUMERO</span>
                    </td>
                    <td rowspan="2" style="border-right: 1px solid black; border-top: 1px solid black;">
                      <span t-out="o.letter_id.related_invoice_names">REF. DEL GIRADOR</span>
                    </td>
                    <td style="font-size: smaller; border-right: 1px solid black; border-top: 1px solid black;">  DIA / MES / AÑO</td>
                    <td rowspan="2" style="border-right: 1px solid black; border-top: 1px solid black;"> LIMA </td>
                    <td style="font-size: smaller; border-right: 1px solid black; border-top: 1px solid black;">  DIA / MES / AÑO</td>
                    <td rowspan="2" style="border-top: 1px solid black; font-size: 150%;">
                      <span t-esc="o.amount_total" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                    </td>
                  </tr>
                  <tr>
                    <td style="border-top: 1px solid black; border-right: 1px solid black;">
                      <span t-field="o.letter_id.invoice_date" t-options='{"format": "dd / MM / yyyy"}'>FECHA DE VENCIMIENTO</span>
                    </td>
                    <td style="border-top: 1px solid black; border-right: 1px solid black;">
                      <span t-field="o.expiration_date" t-options='{"format": "dd / MM / yyyy"}'>FECHA DE VENCIMIENTO</span>
                    </td>
                  </tr>
                </tbody>
              </table>
              <!-- Importe en letras -->
              <div style="width: 100%; margin-top: 2px;">
                <!-- Texto completo -->
                <div style="width: 100%; text-align: justify;">
                  Por esta LETRA DE CAMBIO, se servirá(n) pagar incondicionalmente a la Orden de: 
                  <span t-out="o.company_id.name" style="font-weight: bold;">Nombre de la Compañía</span> 
                  la cantidad de:
                </div>
                <!-- Campo amount_total_text -->
                <div style="border: 2px solid black; padding: 5px; margin-top: 3px; font-size: large; border-radius: 10px; background-color: whitesmoke">
                  <span t-field="o.amount_total_text"/>
                </div>
              </div>
              <!-- Texto de banco -->
              <div style="width: 100%; margin-top: 2px;">
                <!-- Texto completo -->
                <div style="width: 100%; text-align: justify;">
                  En el siguiente lugar de pago, o con cargo en la cuenta del Banco:
                </div>
              </div>
              <!-- Division final del pie de pagina-->
              <table style="width: 100%; border-collapse: collapse; border-collapse: separate; border-spacing: 6px;">
                <tr>
                  <!-- Izquierda superior -->
                  <td style="padding: 5px; vertical-align: top; border: 1px solid black; border-radius: 10px;">
                    <div style="margin-bottom: 1px;">ACEPTANTE:&#160;&#160; <span t-out="o.partner_id.name"/></div>
                    <div style="margin-bottom: 1px;">DOMICILIO:&#160;&#160; <span t-out="o.partner_id.street"/></div>
                    <div style="white-space: pre;">R.U.C. o D.N.I.:&#160;&#160; <span t-out="o.partner_id.vat"/>     TELEF:&#160;&#160;<span t-out="o.partner_id.phone"/></div>
                  </td>
                  <!-- Derecha superior -->
                  <td style="padding: 5px; vertical-align: top; border: 1px solid black; border-radius: 10px;">
                    <p style="margin-bottom: auto;">Importe a debitar en la siguiente cuenta del Banco que se indica:</p>
                    <table style="width: 100%; border-collapse: collapse; border: 1px solid black; font-size: smaller;">
                        <tr>
                          <th style="border: 1px solid black; text-align: center;">ENTIDAD FINANCIERA</th>
                          <th style="border: 1px solid black; text-align: center;">NUMERO DE CUENTA</th>
                        </tr>
                        <t t-foreach="o.company_id.partner_id.bank_ids.filtered(lambda b: b.currency_id == o.currency_id)" t-as="bank">
                          <tr>
                            <td style="border: 1px solid black; text-align: center;">
                              <span t-field="bank.bank_id.name"/>
                            </td>
                            <td style="border: 1px solid black; text-align: center;">
                              <span t-field="bank.acc_number"/>
                            </td>
                          </tr>
                        </t>
                    </table>
                  </td>
                </tr>
                <tr>
                  <!-- Izquierda inferior -->
                  <td style="padding: 5px; vertical-align: top; border: 1px solid black; border-radius: 10px;">
                    <div>AVAL PERMANENTE:</div>
                    <div>DOMICILIO:</div>
                    <div style="white-space: pre;">R.U.C. o D.N.I.: &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;TELEF: </div>
                    <div>FIRMA:</div>
                  </td>
                  <!-- Derecha inferior -->
                  <td style="padding: 5px; text-align: right; border: 1px solid black; border-radius: 10px;">
                    <table class="table-borderless" style="width: 100%;">
                      <tr>
                          <td style="width: 50%; text-align: center;">
                              <!-- Logo de la empresa -->
                              <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)" style="max-height: 45px;" alt="Logo"/>
                          </td>
                          <td style="width: 50%; text-align: center;">
                              <!-- RUC -->
                              <p style="margin: 0;">RUC: <span t-out="o.company_id.vat"/></p>
                          </td>
                      </tr>
                      <tr>
                          <td colspan="2" style="text-align: center; padding-top: 10px;">
                              <!-- Línea de guiones -->
                              <p style="margin: 0;">__________________________________</p>
                              <!-- FIRMA -->
                              <p style="font-weight: bold; margin: 0; font-size: 14px;">FIRMA</p>
                          </td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
              <!-- Clausulas -->
              <div style="width: 100%; margin-top: 0px;">
                <div style="width: 100%; text-align: left; margin-bottom: auto; font-weight: bold; font-size: 13px;">
                  CLÁUSULAS ESPECIALES:
                </div>
                <div style="width: 100%; text-align: left; margin-bottom: 0px; font-size: 12px;">
                  (1) En caso de mora, esta letra de cambio generará las tasas de interés compensatorio y moratorio más altas que la ley permita a su último Tenedor.
                </div>
                <div style="width: 100%; text-align: left; margin-bottom: 0px; font-size: 12px;">
                  (2) El plazo de su vencimiento podrá ser prorrogado por el Tenedor, por el plazo que éste señale, sin que sea necesaria la intervención del obligado principal ni de los solidarios.
                </div>
                <div style="width: 100%; text-align: left; margin-bottom: 0px; font-size: 12px;">
                  (3) Esta letra de cambio no requiere ser protestada por falta de pago.
                </div>
                <div style="width: 100%; text-align: left; margin-bottom: 0px; font-size: 12px;">
                  (4) Su importe debe ser pagado sólo en la misma moneda que expresa este título valor.
                </div>
              </div>
              <table style="width: 100%; margin-top: unset;">
                <tr>
                  <td style="width: 50%; text-align: center; font-size: 11px;">
                    <div style="height: 20px;"></div>
                    __________________________<br/>
                    Aceptante<br/>
                    Nombre/Representante<br/>
                    D.N.I.:
                  </td>
                  <td style="width: 50%; text-align: center; font-size: 11px;">
                    <div style="height: 20px;"></div>
                    __________________________<br/>
                    Aceptante<br/>
                    Nombre/Representante<br/>
                    D.N.I.:
                  </td>
                </tr>
            </table>
            </div>
            <style>
              table.rounded-corners {
                  border-spacing: 0 !important;
                  border-collapse: separate !important;
                  border-radius: 10px !important;
                  border: 1px solid black !important;
                  width: 100% !important;;
                  text-align: center !important;;
                  margin: auto !important;;
              }
            </style>
          </t>
        </div>
      </t>
    </t>
  </template>
</odoo>
